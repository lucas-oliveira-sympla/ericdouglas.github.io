<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Update 2017-08-10: after post this article on /r/vue, one person commented that we don’t need to pass the context since the function will refer to the context where it is called so now in the end of t">
<meta name="keywords" content="vue">
<meta property="og:type" content="article">
<meta property="og:title" content="Better Vue File Organization">
<meta property="og:url" content="http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/index.html">
<meta property="og:site_name" content="Eric Douglas">
<meta property="og:description" content="Update 2017-08-10: after post this article on /r/vue, one person commented that we don’t need to pass the context since the function will refer to the context where it is called so now in the end of t">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2017-08-27T10:55:50.587Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Better Vue File Organization">
<meta name="twitter:description" content="Update 2017-08-10: after post this article on /r/vue, one person commented that we don’t need to pass the context since the function will refer to the context where it is called so now in the end of t">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Better Vue File Organization</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Eric Douglas" type="application/atom+xml" />
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/ericdouglas">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/08/15/basic-cli-postgres-management/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017/06/29/installing-elixir-and-erlang/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&text=Better Vue File Organization"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&is_video=false&description=Better Vue File Organization"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Better Vue File Organization&body=Check out this article: http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&name=Better Vue File Organization&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Better Vue File Organization
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Eric Douglas</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-08-09T23:55:28.000Z" itemprop="datePublished">2017-08-09</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/vue/">vue</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><strong>Update 2017-08-10</strong>: after post this article on <a href="https://www.reddit.com/r/vuejs/" target="_blank" rel="external">/r/vue</a>, one person <a href="https://www.reddit.com/r/vuejs/comments/6spt3o/better_vue_file_organization/dlf5drd/" target="_blank" rel="external">commented</a> that we don’t need to pass the context since the function will refer to the context where it is called so now in the end of the article we’ll have an even cleaner way to organize our files!</p>
<hr>
<p>Before we see an alternative way to organize our vue files/components, I must say although I believe it’s a better approach, in fact, there aren’t <em>right</em> or <em>wrong</em> way, we should follow the way we feel more comfortable to work with.</p>
<p>The following piece of code was extracted from the <a href="https://github.com/mrgodhani/rss-reader/blob/master/app/components/partials/sidebar.vue" target="_blank" rel="external">rss-reader</a> project.</p>
<p>First, we’ll see the original file, and after, the proposed way to organize it.</p>
<p><strong>The mental process</strong></p>
<ol>
<li>Put <strong>all</strong> functions in the bottom of the file.</li>
<li>When a function needs to access <code>this</code> (the current context), we should pass it as the last parameter to our functions.</li>
<li>The <code>ctx</code> parameter you will see is an abbreviation to <code>context</code>.</li>
</ol>
<p><strong>Reasons to change</strong></p>
<ol>
<li>Better way to visualize all methods we have in the file.</li>
<li>Easier way to extract a function to another file if/when necessary.</li>
<li>More “functional” style (!?).</li>
</ol>
<p>Let’s see and compare the traditional approach with the suggested/alternative one.</p>
<p><strong>Traditional approach</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> Feed <span class="keyword">from</span> <span class="string">'../../helpers/feeds'</span></div><div class="line"><span class="keyword">import</span> Favicon <span class="keyword">from</span> <span class="string">'../../helpers/favicon'</span></div><div class="line"><span class="keyword">import</span> queue <span class="keyword">from</span> <span class="string">'../../helpers/queue'</span></div><div class="line"><span class="keyword">import</span> service <span class="keyword">from</span> <span class="string">'../../helpers/services'</span></div><div class="line"><span class="keyword">import</span> &#123; addArticles, addFeed &#125; <span class="keyword">from</span> <span class="string">'../../vuex/actions'</span></div><div class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span></div><div class="line"><span class="keyword">import</span> <span class="keyword">async</span> <span class="keyword">from</span> <span class="string">'async'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  vuex: &#123;</div><div class="line">    getters: &#123;</div><div class="line">      offline: <span class="function"><span class="params">state</span> =&gt;</span> state.offline,</div><div class="line">      feeds: <span class="function"><span class="params">state</span> =&gt;</span> state.feeds</div><div class="line">    &#125;,</div><div class="line">    actions: &#123;</div><div class="line">      addArticles,</div><div class="line">      addFeed</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  computed: &#123;</div><div class="line">    feedData () &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.feeds.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">if</span> (item.title.length &gt;= <span class="number">20</span>) &#123;</div><div class="line">          item.origtitle = item.title</div><div class="line">        &#125;</div><div class="line">        item.title = _.truncate(item.title, &#123; <span class="attr">length</span>: <span class="number">20</span> &#125;)</div><div class="line">        <span class="keyword">return</span> item</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  data () &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      feedurl: <span class="string">''</span>,</div><div class="line">      alertmessage: <span class="string">''</span>,</div><div class="line">      showModal: <span class="literal">false</span>,</div><div class="line">      processed: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    allArticles () &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">replace</span>: <span class="literal">true</span>&#125;)</div><div class="line">    &#125;,</div><div class="line">    tags () &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/tags'</span>, <span class="attr">replace</span>: <span class="literal">true</span>&#125;)</div><div class="line">    &#125;,</div><div class="line">    favourites () &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/favourites'</span>&#125;)</div><div class="line">    &#125;,</div><div class="line">    goFeed (title) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/feed/'</span> + title&#125;)</div><div class="line">    &#125;,</div><div class="line">    readArticles () &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/read'</span>&#125;)</div><div class="line">    &#125;,</div><div class="line">    unreadArticles () &#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/unread'</span>&#125;)</div><div class="line">    &#125;,</div><div class="line">    fetchFeed (callback) &#123;</div><div class="line">      <span class="keyword">let</span> feed = <span class="keyword">new</span> Feed(<span class="keyword">this</span>.feedurl)</div><div class="line">      feed.init().then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">if</span> (result === <span class="literal">null</span>) &#123;</div><div class="line">          <span class="keyword">let</span> error = <span class="string">'Sorry. I couldn\'t figure out any RSS feed on this address. Try to find link to RSS feed on that site by yourself and paste it here.'</span></div><div class="line">          callback(error)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          callback(<span class="literal">null</span>, result)</div><div class="line">        &#125;</div><div class="line">      &#125;, err =&gt; &#123;</div><div class="line">        <span class="keyword">if</span> (err) &#123;&#125;</div><div class="line">        <span class="keyword">let</span> error = <span class="string">'Sorry. Unfortunately this website is not supported.'</span></div><div class="line">        callback(error)</div><div class="line">      &#125;)</div><div class="line">    &#125;,</div><div class="line">    checkFeed (data, callback) &#123;</div><div class="line">      service.checkFeed(data.meta.title, count =&gt; &#123;</div><div class="line">        <span class="keyword">if</span> (count === <span class="number">0</span>) &#123;</div><div class="line">          callback(<span class="literal">null</span>, data)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          callback(<span class="string">'Feed exists'</span>)</div><div class="line">        &#125;</div><div class="line">      &#125;)</div><div class="line">    &#125;,</div><div class="line">    fetchIcon (data, callback) &#123;</div><div class="line">      <span class="keyword">let</span> favicon = <span class="keyword">new</span> Favicon(data.meta.link)</div><div class="line">      favicon.init().then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">let</span> path</div><div class="line">        <span class="keyword">if</span> (result !== <span class="literal">null</span>) &#123;</div><div class="line">          path = queue.queueTask(<span class="string">'favicon'</span>, result)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          path = <span class="literal">null</span></div><div class="line">        &#125;</div><div class="line">        data.meta.favicon = path</div><div class="line">        data.meta.count = data.articles.length</div><div class="line">        callback(<span class="literal">null</span>, data)</div><div class="line">      &#125;)</div><div class="line">    &#125;,</div><div class="line">    addFeedItem (data, callback) &#123;</div><div class="line">      <span class="keyword">this</span>.addFeed(data.meta, result =&gt; &#123;</div><div class="line">        data.meta = result</div><div class="line">        callback(<span class="literal">null</span>, data)</div><div class="line">      &#125;)</div><div class="line">    &#125;,</div><div class="line">    addArticleItems (data, callback) &#123;</div><div class="line">      data.articles.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">let</span> htmlFilename = queue.queueTask(<span class="string">'html'</span>, item.link)</div><div class="line">        item.feed = data.meta.title</div><div class="line">        item.feed_id = data.meta._id</div><div class="line">        item.file = htmlFilename</div><div class="line">        item.favicon = data.meta.favicon</div><div class="line">        <span class="keyword">return</span> item</div><div class="line">      &#125;)</div><div class="line">      <span class="keyword">this</span>.addArticles(data.articles)</div><div class="line">      callback(<span class="literal">null</span>, <span class="string">'done'</span>)</div><div class="line">    &#125;,</div><div class="line">    addFeedData () &#123;</div><div class="line">      <span class="keyword">let</span> self = <span class="keyword">this</span></div><div class="line">      <span class="keyword">this</span>.processed = <span class="literal">true</span></div><div class="line">      <span class="keyword">async</span>.waterfall([</div><div class="line">        <span class="keyword">this</span>.fetchFeed,</div><div class="line">        <span class="keyword">this</span>.checkFeed,</div><div class="line">        <span class="keyword">this</span>.fetchIcon,</div><div class="line">        <span class="keyword">this</span>.addFeedItem,</div><div class="line">        <span class="keyword">this</span>.addArticleItems</div><div class="line">      ], (err, result) =&gt; &#123;</div><div class="line">        <span class="keyword">if</span> (!err) &#123;</div><div class="line">          self.processed = <span class="literal">false</span></div><div class="line">          self.showModal = <span class="literal">false</span></div><div class="line">          <span class="keyword">this</span>.feedurl = <span class="string">''</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          self.alert = <span class="literal">true</span></div><div class="line">          self.alertmessage = err</div><div class="line">          self.processed = <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p><strong>Alternative approach</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> Feed <span class="keyword">from</span> <span class="string">'../../helpers/feeds'</span></div><div class="line"><span class="keyword">import</span> Favicon <span class="keyword">from</span> <span class="string">'../../helpers/favicon'</span></div><div class="line"><span class="keyword">import</span> queue <span class="keyword">from</span> <span class="string">'../../helpers/queue'</span></div><div class="line"><span class="keyword">import</span> service <span class="keyword">from</span> <span class="string">'../../helpers/services'</span></div><div class="line"><span class="keyword">import</span> &#123; addArticles, addFeed &#125; <span class="keyword">from</span> <span class="string">'../../vuex/actions'</span></div><div class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span></div><div class="line"><span class="keyword">import</span> <span class="keyword">async</span> <span class="keyword">from</span> <span class="string">'async'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  vuex: &#123;</div><div class="line">    getters: &#123;</div><div class="line">      offline: <span class="function"><span class="params">state</span> =&gt;</span> state.offline,</div><div class="line">      feeds: <span class="function"><span class="params">state</span> =&gt;</span> state.feeds</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    actions: &#123;</div><div class="line">      addArticles,</div><div class="line">      addFeed</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  computed: &#123;</div><div class="line">    feedData() &#123; feedData(<span class="keyword">this</span>) &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  data () &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      feedurl: <span class="string">''</span>,</div><div class="line">      alertmessage: <span class="string">''</span>,</div><div class="line">      showModal: <span class="literal">false</span>,</div><div class="line">      processed: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  methods: &#123;</div><div class="line">    allArticles() &#123; allArticles(<span class="keyword">this</span>) &#125;,</div><div class="line">    tags() &#123; tags(<span class="keyword">this</span>) &#125;,</div><div class="line">    favourites() &#123; favourites(<span class="keyword">this</span>) &#125;,</div><div class="line">    goFeed() &#123; goFeed(title, <span class="keyword">this</span>) &#125;,</div><div class="line">    readArticles() &#123; readArticles(<span class="keyword">this</span>) &#125;,</div><div class="line">    unreadArticles() &#123; unreadArticles(<span class="keyword">this</span>) &#125;,</div><div class="line">    fetchFeed() &#123; fetchFeed(callback, <span class="keyword">this</span>) &#125;,</div><div class="line">    checkFeed() &#123; checkFeed(data, callback) &#125;,</div><div class="line">    fetchIcon() &#123; fetchIcon (data, callback) &#125;,</div><div class="line">    addFeedItem() &#123; addFeedItem(data, callback, <span class="keyword">this</span>) &#125;,</div><div class="line">    addArticleItems() &#123; addArticleItems(data, callback, <span class="keyword">this</span>) &#125;,</div><div class="line">    addFeedData() &#123; addFeedData(<span class="keyword">this</span>) &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">////////// Computed Properties</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">feedData</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> ctx.feeds.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (item.title.length &gt;= <span class="number">20</span>) &#123;</div><div class="line">      item.origtitle = item.title</div><div class="line">    &#125;</div><div class="line">    item.title = _.truncate(item.title, &#123; <span class="attr">length</span>: <span class="number">20</span> &#125;)</div><div class="line">    <span class="keyword">return</span> item</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">////////// Methods</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">allArticles</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> ctx.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">replace</span>: <span class="literal">true</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tags</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> ctx.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/tags'</span>, <span class="attr">replace</span>: <span class="literal">true</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">favourites</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> ctx.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/favourites'</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">goFeed</span>(<span class="params">title, ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> ctx.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/feed/'</span> + title&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">readArticles</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> ctx.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/read'</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">unreadArticles</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> ctx.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/unread'</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchFeed</span>(<span class="params">callback, ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> feed = <span class="keyword">new</span> Feed(ctx.feedurl)</div><div class="line"></div><div class="line">  feed.init().then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (result === <span class="literal">null</span>) &#123;</div><div class="line">      <span class="keyword">let</span> error = <span class="string">'Sorry. I couldn\'t figure out any RSS feed on this address. Try to find link to RSS feed on that site by yourself and paste it here.'</span></div><div class="line">      callback(error)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      callback(<span class="literal">null</span>, result)</div><div class="line">    &#125;</div><div class="line">  &#125;, err =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;&#125;</div><div class="line">    <span class="keyword">let</span> error = <span class="string">'Sorry. Unfortunately this website is not supported.'</span></div><div class="line">    callback(error)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFeed</span>(<span class="params">data, callback</span>) </span>&#123;</div><div class="line">  service.checkFeed(data.meta.title, count =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (count === <span class="number">0</span>) &#123;</div><div class="line">      callback(<span class="literal">null</span>, data)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      callback(<span class="string">'Feed exists'</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchIcon</span>(<span class="params">data, callback</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> favicon = <span class="keyword">new</span> Favicon(data.meta.link)</div><div class="line">  favicon.init().then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> path</div><div class="line">    <span class="keyword">if</span> (result !== <span class="literal">null</span>) &#123;</div><div class="line">      path = queue.queueTask(<span class="string">'favicon'</span>, result)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      path = <span class="literal">null</span></div><div class="line">    &#125;</div><div class="line">    data.meta.favicon = path</div><div class="line">    data.meta.count = data.articles.length</div><div class="line">    callback(<span class="literal">null</span>, data)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFeedItem</span>(<span class="params">data, callback, ctx</span>) </span>&#123;</div><div class="line">  ctx.addFeed(data.meta, result =&gt; &#123;</div><div class="line">    data.meta = result</div><div class="line">    callback(<span class="literal">null</span>, data)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addArticleItems</span>(<span class="params">data, callback, ctx</span>) </span>&#123;</div><div class="line">  data.articles.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> htmlFilename = queue.queueTask(<span class="string">'html'</span>, item.link)</div><div class="line">    item.feed = data.meta.title</div><div class="line">    item.feed_id = data.meta._id</div><div class="line">    item.file = htmlFilename</div><div class="line">    item.favicon = data.meta.favicon</div><div class="line">    <span class="keyword">return</span> item</div><div class="line">  &#125;)</div><div class="line">  ctx.addArticles(data.articles)</div><div class="line">  callback(<span class="literal">null</span>, <span class="string">'done'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFeedData</span>(<span class="params">ctx</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> self = ctx</div><div class="line">  ctx.processed = <span class="literal">true</span></div><div class="line">  <span class="keyword">async</span>.waterfall([</div><div class="line">    ctx.fetchFeed,</div><div class="line">    ctx.checkFeed,</div><div class="line">    ctx.fetchIcon,</div><div class="line">    ctx.addFeedItem,</div><div class="line">    ctx.addArticleItems</div><div class="line">  ], (err, result) =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (!err) &#123;</div><div class="line">      self.processed = <span class="literal">false</span></div><div class="line">      self.showModal = <span class="literal">false</span></div><div class="line">      ctx.feedurl = <span class="string">''</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      self.alert = <span class="literal">true</span></div><div class="line">      self.alertmessage = err</div><div class="line">      self.processed = <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p><strong>Better and cleaner approach</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> Feed <span class="keyword">from</span> <span class="string">'../../helpers/feeds'</span></div><div class="line"><span class="keyword">import</span> Favicon <span class="keyword">from</span> <span class="string">'../../helpers/favicon'</span></div><div class="line"><span class="keyword">import</span> queue <span class="keyword">from</span> <span class="string">'../../helpers/queue'</span></div><div class="line"><span class="keyword">import</span> service <span class="keyword">from</span> <span class="string">'../../helpers/services'</span></div><div class="line"><span class="keyword">import</span> &#123; addArticles, addFeed &#125; <span class="keyword">from</span> <span class="string">'../../vuex/actions'</span></div><div class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span></div><div class="line"><span class="keyword">import</span> <span class="keyword">async</span> <span class="keyword">from</span> <span class="string">'async'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  vuex: &#123;</div><div class="line">    getters: &#123;</div><div class="line">      offline: <span class="function"><span class="params">state</span> =&gt;</span> state.offline,</div><div class="line">      feeds: <span class="function"><span class="params">state</span> =&gt;</span> state.feeds</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    actions: &#123;</div><div class="line">      addArticles,</div><div class="line">      addFeed</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  computed: &#123;</div><div class="line">    feedData</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  data () &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      feedurl: <span class="string">''</span>,</div><div class="line">      alertmessage: <span class="string">''</span>,</div><div class="line">      showModal: <span class="literal">false</span>,</div><div class="line">      processed: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  methods: &#123;</div><div class="line">    allArticles,</div><div class="line">    tags,</div><div class="line">    favourites,</div><div class="line">    goFeed,</div><div class="line">    readArticles,</div><div class="line">    unreadArticles,</div><div class="line">    fetchFeed,</div><div class="line">    checkFeed,</div><div class="line">    fetchIcon,</div><div class="line">    addFeedItem,</div><div class="line">    addArticleItems,</div><div class="line">    addFeedData</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">////////// Computed Properties</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">feedData</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.feeds.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (item.title.length &gt;= <span class="number">20</span>) &#123;</div><div class="line">      item.origtitle = item.title</div><div class="line">    &#125;</div><div class="line">    item.title = _.truncate(item.title, &#123; <span class="attr">length</span>: <span class="number">20</span> &#125;)</div><div class="line">    <span class="keyword">return</span> item</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">////////// Methods</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">allArticles</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">replace</span>: <span class="literal">true</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tags</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/tags'</span>, <span class="attr">replace</span>: <span class="literal">true</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">favourites</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/favourites'</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">goFeed</span>(<span class="params">title</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/feed/'</span> + title&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">readArticles</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/read'</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">unreadArticles</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.$route.router.go(&#123;<span class="attr">path</span>: <span class="string">'/article/unread'</span>&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchFeed</span>(<span class="params">callback</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> feed = <span class="keyword">new</span> Feed(<span class="keyword">this</span>.feedurl)</div><div class="line"></div><div class="line">  feed.init().then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (result === <span class="literal">null</span>) &#123;</div><div class="line">      <span class="keyword">let</span> error = <span class="string">'Sorry. I couldn\'t figure out any RSS feed on this address. Try to find link to RSS feed on that site by yourself and paste it here.'</span></div><div class="line">      callback(error)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      callback(<span class="literal">null</span>, result)</div><div class="line">    &#125;</div><div class="line">  &#125;, err =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;&#125;</div><div class="line">    <span class="keyword">let</span> error = <span class="string">'Sorry. Unfortunately this website is not supported.'</span></div><div class="line">    callback(error)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFeed</span>(<span class="params">data, callback</span>) </span>&#123;</div><div class="line">  service.checkFeed(data.meta.title, count =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (count === <span class="number">0</span>) &#123;</div><div class="line">      callback(<span class="literal">null</span>, data)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      callback(<span class="string">'Feed exists'</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchIcon</span>(<span class="params">data, callback</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> favicon = <span class="keyword">new</span> Favicon(data.meta.link)</div><div class="line">  favicon.init().then(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> path</div><div class="line">    <span class="keyword">if</span> (result !== <span class="literal">null</span>) &#123;</div><div class="line">      path = queue.queueTask(<span class="string">'favicon'</span>, result)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      path = <span class="literal">null</span></div><div class="line">    &#125;</div><div class="line">    data.meta.favicon = path</div><div class="line">    data.meta.count = data.articles.length</div><div class="line">    callback(<span class="literal">null</span>, data)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFeedItem</span>(<span class="params">data, callback</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.addFeed(data.meta, result =&gt; &#123;</div><div class="line">    data.meta = result</div><div class="line">    callback(<span class="literal">null</span>, data)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addArticleItems</span>(<span class="params">data, callback</span>) </span>&#123;</div><div class="line">  data.articles.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> htmlFilename = queue.queueTask(<span class="string">'html'</span>, item.link)</div><div class="line">    item.feed = data.meta.title</div><div class="line">    item.feed_id = data.meta._id</div><div class="line">    item.file = htmlFilename</div><div class="line">    item.favicon = data.meta.favicon</div><div class="line">    <span class="keyword">return</span> item</div><div class="line">  &#125;)</div><div class="line">  <span class="keyword">this</span>.addArticles(data.articles)</div><div class="line">  callback(<span class="literal">null</span>, <span class="string">'done'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFeedData</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> self = <span class="keyword">this</span></div><div class="line">  <span class="keyword">this</span>.processed = <span class="literal">true</span></div><div class="line">  <span class="keyword">async</span>.waterfall([</div><div class="line">    <span class="keyword">this</span>.fetchFeed,</div><div class="line">    <span class="keyword">this</span>.checkFeed,</div><div class="line">    <span class="keyword">this</span>.fetchIcon,</div><div class="line">    <span class="keyword">this</span>.addFeedItem,</div><div class="line">    <span class="keyword">this</span>.addArticleItems</div><div class="line">  ], (err, result) =&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (!err) &#123;</div><div class="line">      self.processed = <span class="literal">false</span></div><div class="line">      self.showModal = <span class="literal">false</span></div><div class="line">      <span class="keyword">this</span>.feedurl = <span class="string">''</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      self.alert = <span class="literal">true</span></div><div class="line">      self.alertmessage = err</div><div class="line">      self.processed = <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p>Which one do you prefer? Why? Share your thoughts with us :)</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/ericdouglas">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&text=Better Vue File Organization"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&is_video=false&description=Better Vue File Organization"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Better Vue File Organization&body=Check out this article: http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&title=Better Vue File Organization"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/&name=Better Vue File Organization&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 Eric Douglas
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/ericdouglas">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-48165601-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'ericdouglas';
        var disqus_url = 'http://ericdouglas.github.io/2017/08/09/better-vue-file-organization/';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


